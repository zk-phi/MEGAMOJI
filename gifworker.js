(()=>{var t={5958:(t,e)=>{var r=Object.defineProperty;r(e,"__esModule",{value:!0}),((t,e)=>{for(var n in e)r(t,n,{get:e[n],enumerable:!0})})(e,{GIFEncoder:()=>U,applyPalette:()=>m,default:()=>q,nearestColor:()=>C,nearestColorIndex:()=>k,nearestColorIndexWithDistance:()=>x,prequantize:()=>d,quantize:()=>h,snapColorsToPalette:()=>M});var n={signature:"GIF",version:"89a",trailer:59,extensionIntroducer:33,applicationExtensionLabel:255,graphicControlExtensionLabel:249,imageSeparator:44,signatureSize:3,versionSize:3,globalColorTableFlagMask:128,colorResolutionMask:112,sortFlagMask:8,globalColorTableSizeMask:7,applicationIdentifierSize:8,applicationAuthCodeSize:3,disposalMethodMask:28,userInputFlagMask:2,transparentColorFlagMask:1,localColorTableFlagMask:128,interlaceFlagMask:64,idSortFlagMask:32,localColorTableSizeMask:7};function a(t=256){let e=0,r=new Uint8Array(t);return{get buffer(){return r.buffer},reset(){e=0},bytesView:()=>r.subarray(0,e),bytes:()=>r.slice(0,e),writeByte(t){n(e+1),r[e]=t,e++},writeBytes(t,a=0,o=t.length){n(e+o);for(let n=0;n<o;n++)r[e++]=t[n+a]},writeBytesView(t,a=0,o=t.byteLength){n(e+o),r.set(t.subarray(a,a+o),e),e+=o}};function n(t){var n=r.length;if(n>=t)return;t=Math.max(t,n*(n<1048576?2:1.125)>>>0),0!=n&&(t=Math.max(t,256));const a=r;r=new Uint8Array(t),e>0&&r.set(a.subarray(0,e),0)}}var o=12,i=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],c=function(t,e,r,n,c=a(512),l=new Uint8Array(256),s=new Int32Array(5003),f=new Int32Array(5003)){const u=s.length,w=Math.max(2,n);l.fill(0),f.fill(0),s.fill(-1);let y=0,h=0;const g=w+1,b=g;let p=!1,d=b,m=(1<<d)-1;const B=1<<g-1,A=B+1;let M=B+2,v=0,k=r[0],x=0;for(let t=u;t<65536;t*=2)++x;x=8-x,c.writeByte(w),U(B);const C=r.length;for(let t=1;t<C;t++)t:{const e=r[t],n=(e<<o)+k;let a=e<<x^k;if(s[a]===n){k=f[a];break t}const i=0===a?1:u-a;for(;s[a]>=0;)if(a-=i,a<0&&(a+=u),s[a]===n){k=f[a];break t}U(k),k=e,M<1<<o?(f[a]=M++,s[a]=n):(s.fill(-1),M=B+2,p=!0,U(B))}return U(k),U(A),c.writeByte(0),c.bytesView();function U(t){for(y&=i[h],h>0?y|=t<<h:y=t,h+=d;h>=8;)l[v++]=255&y,v>=254&&(c.writeByte(v),c.writeBytesView(l,0,v),v=0),y>>=8,h-=8;if((M>m||p)&&(p?(d=b,m=(1<<d)-1,p=!1):(++d,m=d===o?1<<d:(1<<d)-1)),t==A){for(;h>0;)l[v++]=255&y,v>=254&&(c.writeByte(v),c.writeBytesView(l,0,v),v=0),y>>=8,h-=8;v>0&&(c.writeByte(v),c.writeBytesView(l,0,v),v=0)}}};function l(t,e,r){return t<<8&63488|e<<2&992|r>>3}function s(t,e,r,n){return t>>4|240&e|(240&r)<<4|(240&n)<<8}function f(t,e,r){return t>>4<<8|240&e|r>>4}function u(t,e,r){return t<e?e:t>r?r:t}function w(t){return t*t}function y(t,e,r){var n=0,a=1e100;const o=t[e],i=o.cnt,c=o.ac,l=o.rc,s=o.gc,f=o.bc;for(var u=o.fw;0!=u;u=t[u].fw){const e=t[u],o=e.cnt,h=i*o/(i+o);if(!(h>=a)){var y=0;r&&(y+=h*w(e.ac-c))>=a||(y+=h*w(e.rc-l))>=a||(y+=h*w(e.gc-s))>=a||(y+=h*w(e.bc-f))>=a||(a=y,n=u)}}o.err=a,o.nn=n}function h(t,e,r={}){const{format:n="rgb565",clearAlpha:a=!0,clearAlphaColor:o=0,clearAlphaThreshold:i=0,oneBitAlpha:c=!1}=r;if(!t||!t.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(t instanceof Uint8Array||t instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");const h=new Uint32Array(t.buffer);let b=!1!==r.useSqrt;const p="rgba4444"===n,d=function(t,e){const r=new Array("rgb444"===e?4096:65536),n=t.length;if("rgba4444"===e)for(let e=0;e<n;++e){const n=t[e],a=n>>24&255,o=n>>16&255,i=n>>8&255,c=255&n,l=s(c,i,o,a);let f=l in r?r[l]:r[l]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};f.rc+=c,f.gc+=i,f.bc+=o,f.ac+=a,f.cnt++}else if("rgb444"===e)for(let e=0;e<n;++e){const n=t[e],a=n>>16&255,o=n>>8&255,i=255&n,c=f(i,o,a);let l=c in r?r[c]:r[c]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};l.rc+=i,l.gc+=o,l.bc+=a,l.cnt++}else for(let e=0;e<n;++e){const n=t[e],a=n>>16&255,o=n>>8&255,i=255&n,c=l(i,o,a);let s=c in r?r[c]:r[c]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};s.rc+=i,s.gc+=o,s.bc+=a,s.cnt++}return r}(h,n),m=d.length,B=m-1,A=new Uint32Array(m+1);for(var M=0,v=0;v<m;++v){const t=d[v];if(null!=t){var k=1/t.cnt;p&&(t.ac*=k),t.rc*=k,t.gc*=k,t.bc*=k,d[M++]=t}}var x,C,U;for(w(e)/M<.022&&(b=!1),v=0;v<M-1;++v)d[v].fw=v+1,d[v+1].bk=v,b&&(d[v].cnt=Math.sqrt(d[v].cnt));for(b&&(d[v].cnt=Math.sqrt(d[v].cnt)),v=0;v<M;++v){y(d,v,!1);var F=d[v].err;for(C=++A[0];C>1&&!(d[x=A[U=C>>1]].err<=F);C=U)A[C]=x;A[C]=v}var I=M-e;for(v=0;v<I;){for(var z;;){var E=A[1];if((z=d[E]).tm>=z.mtm&&d[z.nn].mtm<=z.tm)break;for(z.mtm==B?E=A[1]=A[A[0]--]:(y(d,E,!1),z.tm=v),F=d[E].err,C=1;(U=C+C)<=A[0]&&(U<A[0]&&d[A[U]].err>d[A[U+1]].err&&U++,!(F<=d[x=A[U]].err));C=U)A[C]=x;A[C]=E}var q=d[z.nn],S=z.cnt,G=q.cnt;k=1/(S+G),p&&(z.ac=k*(S*z.ac+G*q.ac)),z.rc=k*(S*z.rc+G*q.rc),z.gc=k*(S*z.gc+G*q.gc),z.bc=k*(S*z.bc+G*q.bc),z.cnt+=q.cnt,z.mtm=++v,d[q.bk].fw=q.fw,d[q.fw].bk=q.bk,q.mtm=B}let P=[];var V=0;for(v=0;;++V){let t=u(Math.round(d[v].rc),0,255),e=u(Math.round(d[v].gc),0,255),r=u(Math.round(d[v].bc),0,255),n=255;p&&(n=u(Math.round(d[v].ac),0,255),c&&(n=n<=("number"==typeof c?c:127)?0:255),a&&n<=i&&(t=e=r=o,n=0));const l=p?[t,e,r,n]:[t,e,r];if(g(P,l)||P.push(l),0==(v=d[v].fw))break}return P}function g(t,e){for(let r=0;r<t.length;r++){const n=t[r];let a=n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2],o=!(n.length>=4&&e.length>=4)||n[3]===e[3];if(a&&o)return!0}return!1}function b(t,e){var r,n=0;for(r=0;r<t.length;r++){const a=t[r]-e[r];n+=a*a}return n}function p(t,e){return e>1?Math.round(t/e)*e:t}function d(t,{roundRGB:e=5,roundAlpha:r=10,oneBitAlpha:n=null}={}){const a=new Uint32Array(t.buffer);for(let t=0;t<a.length;t++){const o=a[t];let i=o>>24&255,c=o>>16&255,l=o>>8&255,s=255&o;i=p(i,r),n&&(i=i<=("number"==typeof n?n:127)?0:255),s=p(s,e),l=p(l,e),c=p(c,e),a[t]=i<<24|c<<16|l<<8|s<<0}}function m(t,e,r="rgb565"){if(!t||!t.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(t instanceof Uint8Array||t instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");if(e.length>256)throw new Error("applyPalette() only works with 256 colors or less");const n=new Uint32Array(t.buffer),a=n.length,o="rgb444"===r?4096:65536,i=new Uint8Array(a),c=new Array(o);if("rgba4444"===r)for(let t=0;t<a;t++){const r=n[t],a=r>>24&255,o=r>>16&255,l=r>>8&255,f=255&r,u=s(f,l,o,a),w=u in c?c[u]:c[u]=B(f,l,o,a,e);i[t]=w}else{const t="rgb444"===r?f:l;for(let r=0;r<a;r++){const a=n[r],o=a>>16&255,l=a>>8&255,s=255&a,f=t(s,l,o),u=f in c?c[f]:c[f]=A(s,l,o,e);i[r]=u}}return i}function B(t,e,r,n,a){let o=0,i=1e100;for(let c=0;c<a.length;c++){const l=a[c];let s=v(l[3]-n);s>i||(s+=v(l[0]-t),s>i||(s+=v(l[1]-e),s>i||(s+=v(l[2]-r),s>i||(i=s,o=c))))}return o}function A(t,e,r,n){let a=0,o=1e100;for(let i=0;i<n.length;i++){const c=n[i];let l=v(c[0]-t);l>o||(l+=v(c[1]-e),l>o||(l+=v(c[2]-r),l>o||(o=l,a=i)))}return a}function M(t,e,r=5){if(!t.length||!e.length)return;const n=t.map((t=>t.slice(0,3))),a=r*r,o=t[0].length;for(let r=0;r<e.length;r++){let i=e[r];i=i.length<o?[i[0],i[1],i[2],255]:i.length>o?i.slice(0,3):i.slice();const c=x(n,i.slice(0,3),b),l=c[0],s=c[1];s>0&&s<=a&&(t[l]=i)}}function v(t){return t*t}function k(t,e,r=b){let n=1/0,a=-1;for(let o=0;o<t.length;o++){const i=r(e,t[o]);i<n&&(n=i,a=o)}return a}function x(t,e,r=b){let n=1/0,a=-1;for(let o=0;o<t.length;o++){const i=r(e,t[o]);i<n&&(n=i,a=o)}return[a,n]}function C(t,e,r=b){return t[k(t,e,r)]}function U(t={}){const{initialCapacity:e=4096,auto:r=!0}=t,o=a(e),i=new Uint8Array(256),l=new Int32Array(5003),s=new Int32Array(5003);let f=!1;return{reset(){o.reset(),f=!1},finish(){o.writeByte(n.trailer)},bytes:()=>o.bytes(),bytesView:()=>o.bytesView(),get buffer(){return o.buffer},get stream(){return o},writeHeader:u,writeFrame(t,e,n,a={}){const{transparent:w=!1,transparentIndex:y=0,delay:h=0,palette:g=null,repeat:b=0,colorDepth:p=8,dispose:d=-1}=a;let m=!1;if(r?f||(m=!0,u(),f=!0):m=Boolean(a.first),e=Math.max(0,Math.floor(e)),n=Math.max(0,Math.floor(n)),m){if(!g)throw new Error("First frame must include a { palette } option");!function(t,e,r,n,a=8){const o=128|a-1<<4|E(n.length)-1;I(t,e),I(t,r),t.writeBytes([o,0,0])}(o,e,n,g,p),F(o,g),b>=0&&function(t,e){t.writeByte(33),t.writeByte(255),t.writeByte(11),z(t,"NETSCAPE2.0"),t.writeByte(3),t.writeByte(1),I(t,e),t.writeByte(0)}(o,b)}const B=Math.round(h/10);!function(t,e,r,n,a){var o,i;t.writeByte(33),t.writeByte(249),t.writeByte(4),a<0&&(a=0,n=!1),n?(o=1,i=2):(o=0,i=0),e>=0&&(i=7&e),i<<=2;t.writeByte(0|i|o),I(t,r),t.writeByte(a||0),t.writeByte(0)}(o,d,B,w,y);const A=Boolean(g)&&!m;!function(t,e,r,n){if(t.writeByte(44),I(t,0),I(t,0),I(t,e),I(t,r),n){const e=0,r=0,a=E(n.length)-1;t.writeByte(128|e|r|0|a)}else t.writeByte(0)}(o,e,n,A?g:null),A&&F(o,g),function(t,e,r,n,a=8,o,i,l){c(r,n,e,a,t,o,i,l)}(o,t,e,n,p,i,l,s)}};function u(){z(o,"GIF89a")}}function F(t,e){const r=1<<E(e.length);for(let n=0;n<r;n++){let r=[0,0,0];n<e.length&&(r=e[n]),t.writeByte(r[0]),t.writeByte(r[1]),t.writeByte(r[2])}}function I(t,e){t.writeByte(255&e),t.writeByte(e>>8&255)}function z(t,e){for(var r=0;r<e.length;r++)t.writeByte(e.charCodeAt(r))}function E(t){return Math.max(Math.ceil(Math.log2(t)),1)}var q=U}},e={};function r(n){var a=e[n];if(void 0!==a)return a.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=r(5958);const e=self,n=(0,t.GIFEncoder)();e.addEventListener("message",(r=>{if(r.data.addFrame){const{data:e,transparent:a,width:o,height:i,delay:c}=r.data.addFrame,l=(0,t.quantize)(e,256,{oneBitAlpha:a}),s=(0,t.applyPalette)(e,l);n.writeFrame(s,o,i,{palette:l,delay:c,transparent:a})}else r.data.finish&&(n.finish(),e.postMessage(new Blob([n.bytes()],{type:"image/gif"})))}))})()})();
//# sourceMappingURL=gifworker.js.map